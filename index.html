<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vaccine Mandate Decision Aid Tool</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papNMzNnQn5iH+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Vaccine Mandate Decision Aid Tool</h1>
      <p>
        This tool helps you explore and compare vaccine mandate scenarios based on public preferences in Australia, France, and Italy.
      </p>
    </header>

    <nav class="tabs" role="tablist">
      <button class="tablink active" data-tab="introTab" aria-selected="true">
        <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
      </button>
      <button class="tablink" data-tab="instructionsTab" aria-selected="false">
        <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
      </button>
      <button class="tablink" data-tab="attributesTab" aria-selected="false">
        <i class="fa-solid fa-list"></i><span> Attributes</span>
      </button>
      <button class="tablink" data-tab="inputsTab" aria-selected="false">
        <i class="fa-solid fa-sliders"></i><span> Inputs</span>
      </button>
      <button class="tablink" data-tab="wtpTab" aria-selected="false">
        <i class="fa-solid fa-chart-bar"></i><span> WTP Results</span>
      </button>
      <button class="tablink" data-tab="probTab" aria-selected="false">
        <i class="fa-solid fa-chart-pie"></i><span> Predicted Uptake</span>
      </button>
      <button class="tablink" data-tab="costsTab" aria-selected="false">
        <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
      </button>
      <button class="tablink" data-tab="scenariosTab" aria-selected="false">
        <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
      </button>
    </nav>

    <!-- Introduction Tab -->
    <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
      <div class="intro-box">
        <p>
          Public preferences regarding vaccine mandates can vary with policy features. This decision aid tool uses discrete choice experiment estimates—based on theoretical expectations and evidence (e.g., Betsch et al., 2018; Larson et al., 2014)—to illustrate trade‐offs between attributes such as the mandate scope, infection threshold, vaccine coverage requirements, incentives, and exemption policies.
        </p>
        <ul>
          <li><strong>Instructions</strong> – How to navigate the tool.</li>
          <li><strong>Attributes</strong> – Explanation of each mandate feature.</li>
          <li><strong>Inputs</strong> – Set your scenario levels (including country selection).</li>
          <li><strong>WTP Results</strong> – View willingness‐to‐pay estimates for each attribute.</li>
          <li><strong>Predicted Uptake</strong> – See uptake probabilities and participant numbers (base = 2000 per country).</li>
          <li><strong>Costs &amp; Benefits</strong> – Explore a cost–benefit analysis of the scenario.</li>
          <li><strong>Saved Scenarios</strong> – Compare and export your saved configurations.</li>
        </ul>
      </div>
    </section>

    <!-- Instructions Tab -->
    <section id="instructionsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>How to Use This Tool</h4>
        <ol>
          <li>Review the <strong>Attributes</strong> tab to understand each mandate feature.</li>
          <li>Configure your scenario in the <strong>Inputs</strong> tab – first select a country, then choose levels for each attribute.</li>
          <li>Click “Calculate &amp; View Results” to see predicted uptake and trade‐offs.</li>
          <li>Examine the <strong>WTP Results</strong> tab for monetary values associated with attribute changes.</li>
          <li>Check the <strong>Predicted Uptake</strong> tab for uptake percentages and projected participant numbers.</li>
          <li>Review the <strong>Costs &amp; Benefits</strong> tab for a cost–benefit analysis.</li>
          <li>Save and compare scenarios in the <strong>Saved Scenarios</strong> tab or export the results to PDF.</li>
        </ol>
      </div>
    </section>

    <!-- Attributes Tab -->
    <section id="attributesTab" class="tabcontent" tabindex="0">
      <h2>Key Mandate Attributes</h2>
      <div class="attributes-list">
        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-briefcase" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Only individuals in high‐risk occupations are mandated.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Scope of Mandate</h4>
            <p>
              <strong>Reference:</strong> High‑risk occupations only.<br>
              <strong>Alternative:</strong> All occupations and public spaces.
            </p>
          </div>
        </div>

        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-virus" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Activation thresholds based on infection rates.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Infection Threshold</h4>
            <p>
              <strong>Reference:</strong> 50 cases/100k with 10% weekly increase.<br>
              <strong>Alternatives:</strong> 100 cases/100k (15% increase) or 200 cases/100k (20% increase).
            </p>
          </div>
        </div>

        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-shield-halved" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Mandate lifting based on vaccine coverage.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Vaccine Coverage Requirement</h4>
            <p>
              <strong>Reference:</strong> 50% coverage.<br>
              <strong>Alternatives:</strong> 70% or 90% coverage.
            </p>
          </div>
        </div>

        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-hand-holding-dollar" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Incentives may include paid leave or subsidies.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Incentives for Vaccination</h4>
            <p>
              <strong>Reference:</strong> No incentives.<br>
              <strong>Alternatives:</strong> Paid time off or government subsidy/discount.
            </p>
          </div>
        </div>

        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-user-check" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Exemption policies determine who may opt out.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Exemption Policy</h4>
            <p>
              <strong>Reference:</strong> Medical exemptions only.<br>
              <strong>Alternatives:</strong> Medical plus religious, or broad personal belief exemptions.
            </p>
          </div>
        </div>

        <div class="attribute-card" tabindex="0">
          <div class="attribute-icon">
            <i class="fa-solid fa-money-bill-wave" aria-hidden="true"></i>
            <div class="tooltip" role="tooltip">
              Financial rewards offered for compliance.
            </div>
          </div>
          <div class="attribute-content">
            <h4>Financial Incentive Amount</h4>
            <p>
              Continuous attribute ranging from $0 to $500.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Inputs Tab -->
    <section id="inputsTab" class="tabcontent" tabindex="0">
      <div class="input-card">
        <h2>Scenario Inputs</h2>
        <p>Configure your vaccine mandate scenario by selecting the levels for each feature.</p>
        <form onsubmit="event.preventDefault();">
          <div class="input-cards">
            <!-- Country Selection -->
            <div class="input-level-card">
              <h3>Select Country</h3>
              <div class="options">
                <select id="country_select">
                  <option value="Australia">Australia</option>
                  <option value="France">France</option>
                  <option value="Italy">Italy</option>
                </select>
              </div>
            </div>
            <!-- Scope of Mandate -->
            <div class="input-level-card">
              <h3>Scope of Mandate <span class="reference">(Reference: High‑risk occupations only)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="scope" value="highRisk" checked>
                  High‑risk occupations only
                </label>
                <label>
                  <input type="radio" name="scope" value="all">
                  All occupations and public spaces
                </label>
              </div>
            </div>
            <!-- Infection Threshold -->
            <div class="input-level-card">
              <h3>Infection Threshold <span class="reference">(Reference: 50/100k, 10% increase)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="threshold" value="50" checked>
                  50 cases/100k with 10% weekly increase
                </label>
                <label>
                  <input type="radio" name="threshold" value="100">
                  100 cases/100k with 15% weekly increase
                </label>
                <label>
                  <input type="radio" name="threshold" value="200">
                  200 cases/100k with 20% weekly increase
                </label>
              </div>
            </div>
            <!-- Vaccine Coverage -->
            <div class="input-level-card">
              <h3>Vaccine Coverage Requirement <span class="reference">(Reference: 50%)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="coverage" value="50" checked>
                  50%
                </label>
                <label>
                  <input type="radio" name="coverage" value="70">
                  70%
                </label>
                <label>
                  <input type="radio" name="coverage" value="90">
                  90%
                </label>
              </div>
            </div>
            <!-- Incentives -->
            <div class="input-level-card">
              <h3>Incentives for Vaccination <span class="reference">(Reference: No incentives)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="incentive" value="none" checked>
                  No incentives
                </label>
                <label>
                  <input type="radio" name="incentive" value="paid">
                  Paid time off (1–3 days)
                </label>
                <label>
                  <input type="radio" name="incentive" value="govsub">
                  Government subsidy/discount
                </label>
              </div>
            </div>
            <!-- Exemption Policy -->
            <div class="input-level-card">
              <h3>Exemption Policy <span class="reference">(Reference: Medical exemptions only)</span></h3>
              <div class="options">
                <label>
                  <input type="radio" name="exemption" value="medical" checked>
                  Medical exemptions only
                </label>
                <label>
                  <input type="radio" name="exemption" value="medRel">
                  Medical and religious exemptions
                </label>
                <label>
                  <input type="radio" name="exemption" value="all">
                  Medical, religious &amp; personal belief exemptions
                </label>
              </div>
            </div>
            <!-- Financial Incentive -->
            <div class="input-level-card">
              <h3>Financial Incentive Amount (USD)</h3>
              <div class="options slider-option">
                <label for="financialSlider">
                  <i class="fa-solid fa-dollar-sign"></i>
                  <span id="financialLabel">0</span>
                </label>
                <input type="range" id="financialSlider" min="0" max="500" step="1" value="0" oninput="updateFinancialDisplay(this.value)" />
              </div>
            </div>
          </div>
          <div class="buttons-row">
            <button type="button" onclick="calculateScenario()">Calculate &amp; View Results</button>
          </div>
        </form>
        <!-- Modal Popup for Results -->
        <div id="resultModal" class="modal">
          <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <div id="modalResults"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- WTP Results Tab -->
    <section id="wtpTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Willingness-to-Pay (WTP) Estimates</h4>
        <p>
          WTP for each mandate attribute is computed as: 
          <br><em>WTP = - (β_attribute) / (β_Financial_Incentive)</em>
          <br>
          (Illustrative estimates based on theoretical expectations; see, for example, Betsch et al., 2018 and Larson et al., 2014.)
        </p>
        <div class="buttons-row">
          <button onclick="renderWTPChart()">Show WTP Charts</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box">
            <h3>WTP (USD)</h3>
            <canvas id="wtpChartMain"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Predicted Uptake Tab -->
    <section id="probTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Predicted Mandate Uptake</h4>
        <p>Click “Show Uptake Chart” to compute the predicted uptake percentage and projected number of participants (base = 2000 per country).</p>
        <div class="buttons-row">
          <button onclick="renderUptakeChart()">Show Uptake Chart</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box" style="position: relative; height:300px;">
            <h3>Uptake vs. Non‑uptake</h3>
            <canvas id="uptakeChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Costs & Benefits Tab -->
    <section id="costsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Costs &amp; Benefits Analysis</h4>
        <div id="costsBenefitsResults">
          <!-- Summary and chart will render here -->
        </div>
      </div>
    </section>

    <!-- Scenarios Tab -->
    <section id="scenariosTab" class="tabcontent" tabindex="0">
      <div class="calculation-info">
        <h4>Saved Scenarios</h4>
        <p>Each row displays the selected inputs along with the computed uptake and projected participant count.</p>
        <div class="buttons-row">
          <button onclick="saveScenario()">Save Current Scenario</button>
          <button onclick="openComparison()">Compare &amp; Export to PDF</button>
        </div>
        <div class="table-container">
          <table id="scenarioTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Country</th>
                <th>Scope</th>
                <th>Threshold</th>
                <th>Coverage</th>
                <th>Incentive</th>
                <th>Exemption</th>
                <th>Financial ($)</th>
                <th>Uptake (%)</th>
                <th>Participants</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer>
      <p>&copy; 2025 Vaccine Mandate Decision Aid Tool</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
