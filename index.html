<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vaccine Mandate Decision Aid Tool</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-papNMzNnQn5iH+1G+FHu8SyuXHs6A1k+Ln7tK5qRo1l5eYm6Jzv+1pArJ7N4C9FfpRrmAgM3tYWd3FZ9jKz1Bw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Chart.js Library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- jsPDF Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <h1>Vaccine Mandate Decision Aid Tool</h1>
      <p>
        Explore and compare vaccine mandate scenarios based on public preferences in Australia, France, and Italy.
      </p>
    </header>

    <nav class="tabs" role="tablist">
      <button class="tablink active" data-tab="introTab" aria-selected="true">
        <i class="fa-solid fa-info-circle"></i><span> Introduction</span>
      </button>
      <button class="tablink" data-tab="instructionsTab" aria-selected="false">
        <i class="fa-solid fa-circle-question"></i><span> Instructions</span>
      </button>
      <button class="tablink" data-tab="attributesTab" aria-selected="false">
        <i class="fa-solid fa-list"></i><span> Attributes</span>
      </button>
      <button class="tablink" data-tab="inputsTab" aria-selected="false">
        <i class="fa-solid fa-sliders"></i><span> Inputs</span>
      </button>
      <button class="tablink" data-tab="mrsTab" aria-selected="false">
        <i class="fa-solid fa-exchange-alt"></i><span> MRS</span>
      </button>
      <button class="tablink" data-tab="probTab" aria-selected="false">
        <i class="fa-solid fa-chart-pie"></i><span> Predicted Uptake</span>
      </button>
      <button class="tablink" data-tab="costsTab" aria-selected="false">
        <i class="fa-solid fa-calculator"></i><span> Costs &amp; Benefits</span>
      </button>
      <button class="tablink" data-tab="scenariosTab" aria-selected="false">
        <i class="fa-solid fa-folder-open"></i><span> Saved Scenarios</span>
      </button>
    </nav>

    <!-- Introduction Tab -->
    <section id="introTab" class="tabcontent" tabindex="0" style="display: block;">
      <div class="intro-box card">
        <p>
          Vaccine mandates can vary in scope and conditions. This tool uses discrete choice experiment estimates based on theoretical and empirical research (e.g., Betsch et al., 2018; Larson et al., 2014) to illustrate trade-offs between key policy attributes.
        </p>
        <ul>
          <li><strong>Instructions</strong> – How to navigate the tool.</li>
          <li><strong>Attributes</strong> – Detailed descriptions of each mandate feature, with benchmarks shown in brackets.</li>
          <li><strong>Inputs</strong> – Configure your scenario by selecting alternative levels (the benchmark is indicated and not selectable).</li>
          <li><strong>MRS</strong> – View marginal rates of substitution between selected attributes.</li>
          <li><strong>Predicted Uptake</strong> – See the predicted uptake percentage and estimated number of participants (base = 2000 per country).</li>
          <li><strong>Costs &amp; Benefits</strong> – Analyze detailed cost components and benefits, dynamically calculated based on uptake.</li>
          <li><strong>Saved Scenarios</strong> – Compare and export your saved configurations.</li>
        </ul>
      </div>
    </section>

    <!-- Instructions Tab -->
    <section id="instructionsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info card">
        <h4>How to Use This Tool</h4>
        <ol class="instruction-list">
          <li>Review the <strong>Attributes</strong> tab to understand each mandate feature. Hover over info icons for details.</li>
          <li>Configure your scenario in the <strong>Inputs</strong> tab. The benchmark (reference) level is shown without a radio button; select only if you wish to deviate.</li>
          <li>Select the country first (Australia, France, or Italy).</li>
          <li>For each attribute, choose an alternative level if desired. If no alternative is selected, the benchmark is assumed.</li>
          <li>Click “Calculate &amp; View Results” to see the predicted uptake and trade-offs (MRS) among attributes.</li>
          <li>Examine the <strong>MRS</strong> tab to understand the trade-offs between key attributes.</li>
          <li>Check the <strong>Predicted Uptake</strong> tab for uptake percentages and estimated participants.</li>
          <li>Review the <strong>Costs &amp; Benefits</strong> tab for a detailed breakdown of cost components and benefits, calculated dynamically.</li>
          <li>Save scenarios in the <strong>Saved Scenarios</strong> tab and export comparisons to PDF.</li>
        </ol>
      </div>
    </section>

    <!-- Attributes Tab -->
    <section id="attributesTab" class="tabcontent" tabindex="0">
      <h2>Key Mandate Attributes</h2>
      <div class="attributes-list column">
        <!-- Attribute 1: Scope of the Mandate -->
        <div class="attribute-card card">
          <div class="attribute-icon">
            <!-- SVG Icon for Scope -->
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="#2980b9" d="M12 2L2 7h20L12 2zm0 2.18L18.82 7H5.18L12 4.18zM4 9v11h16V9H4zm2 2h12v7H6v-7z"/>
            </svg>
            <i class="fa-solid fa-info-circle info-icon"></i>
            <span class="tooltip">Benchmark: High‑risk occupations only<br><em>Only for high-risk roles (e.g., healthcare, border protection).</em></span>
          </div>
          <div class="attribute-content">
            <h4>Scope of the Mandate (Benchmark: High‑risk occupations only)</h4>
            <p>
              Alternative: All occupations and public spaces – vaccines required for everyone in workplaces and public areas.
            </p>
          </div>
        </div>

        <!-- Attribute 2: Infection Threshold -->
        <div class="attribute-card card">
          <div class="attribute-icon">
            <!-- SVG Icon for Infection Threshold -->
            <svg width="24" height="24" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10" fill="#e74c3c"/>
              <path d="M12 6v6l4 2" stroke="#fff" stroke-width="2" fill="none"/>
            </svg>
            <i class="fa-solid fa-info-circle info-icon"></i>
            <span class="tooltip">Benchmark: 50 cases/100k with 10% weekly increase<br><em>Moderate strain on healthcare.</em></span>
          </div>
          <div class="attribute-content">
            <h4>Infection Threshold (Benchmark: 50 cases/100k, 10% increase)</h4>
            <p>
              Alternatives:<br>
              – 100 cases/100k with 15% weekly increase: Significant strain.<br>
              – 200 cases/100k with 20% weekly increase: Severe strain.
            </p>
          </div>
        </div>

        <!-- Attribute 3: Vaccine Coverage Requirement -->
        <div class="attribute-card card">
          <div class="attribute-icon">
            <!-- SVG Icon for Vaccine Coverage -->
            <svg width="24" height="24" viewBox="0 0 24 24">
              <rect x="3" y="3" width="18" height="18" fill="#27ae60"/>
              <path d="M7 7h10v10H7z" fill="#fff"/>
            </svg>
            <i class="fa-solid fa-info-circle info-icon"></i>
            <span class="tooltip">Benchmark: 50% vaccine coverage<br><em>Half the population vaccinated.</em></span>
          </div>
          <div class="attribute-content">
            <h4>Vaccine Coverage Requirement (Benchmark: 50%)</h4>
            <p>
              Alternatives:<br>
              – Moderate (70% coverage): Fewer outbreaks.<br>
              – High (90% coverage): Safe lifting of mandates.
            </p>
          </div>
        </div>

        <!-- Attribute 4: Incentives/Benefits -->
        <div class="attribute-card card">
          <div class="attribute-icon">
            <!-- SVG Icon for Incentives -->
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="#f1c40f" d="M12 2L2 7l10 5 10-5-10-5z"/>
              <path fill="#f39c12" d="M2 17l10 5 10-5"/>
              <path fill="#f39c12" d="M2 12l10 5 10-5"/>
            </svg>
            <i class="fa-solid fa-info-circle info-icon"></i>
            <span class="tooltip">Benchmark: None<br><em>No incentives provided.</em></span>
          </div>
          <div class="attribute-content">
            <h4>Incentives for Vaccination (Benchmark: None)</h4>
            <p>
              Alternatives:<br>
              – Paid time off (1–3 days): Provides leave for vaccination.<br>
              – Government subsidy/discount: 10% discount on services.
            </p>
          </div>
        </div>

        <!-- Attribute 5: Exemption Policy -->
        <div class="attribute-card card">
          <div class="attribute-icon">
            <!-- SVG Icon for Exemptions -->
            <svg width="24" height="24" viewBox="0 0 24 24">
              <path fill="#8e44ad" d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm1 15h-2v-2h2zm0-4h-2V7h2z"/>
            </svg>
            <i class="fa-solid fa-info-circle info-icon"></i>
            <span class="tooltip">Benchmark: Medical exemptions only<br><em>Only medically verified exemptions allowed.</em></span>
          </div>
          <div class="attribute-content">
            <h4>Exemption Policy (Benchmark: Medical exemptions only)</h4>
            <p>
              Alternatives:<br>
              – Medical and religious exemptions.<br>
              – Medical, religious, and broad personal belief exemptions.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Inputs Tab -->
    <section id="inputsTab" class="tabcontent" tabindex="0">
      <div class="input-card card">
        <h2>Scenario Inputs</h2>
        <p>Configure your vaccine mandate scenario by selecting alternative levels for each attribute. The benchmark (reference) level is shown (without a radio button) and is applied by default if no alternative is selected.</p>
        <form onsubmit="event.preventDefault();">
          <div class="input-cards">
            <!-- Country Selection -->
            <div class="input-level-card">
              <h3>Select Country</h3>
              <div class="options">
                <select id="country_select">
                  <option value="Australia">Australia</option>
                  <option value="France">France</option>
                  <option value="Italy">Italy</option>
                </select>
              </div>
            </div>
            <!-- Scope of Mandate -->
            <div class="input-level-card">
              <h3>Scope of the Mandate</h3>
              <p>Benchmark: High‑risk occupations only</p>
              <div class="options">
                <label>
                  <input type="radio" name="scope" value="all">
                  All occupations and public spaces
                </label>
              </div>
            </div>
            <!-- Infection Threshold -->
            <div class="input-level-card">
              <h3>Infection Threshold for Mandate Activation</h3>
              <p>Benchmark: 50 cases/100k with 10% weekly increase</p>
              <div class="options">
                <label>
                  <input type="radio" name="threshold" value="100">
                  100 cases/100k with 15% weekly increase
                </label>
                <label>
                  <input type="radio" name="threshold" value="200">
                  200 cases/100k with 20% weekly increase
                </label>
              </div>
            </div>
            <!-- Vaccine Coverage Requirement -->
            <div class="input-level-card">
              <h3>Vaccine Coverage Requirement for Lifting Mandates</h3>
              <p>Benchmark: Low vaccine coverage (50%)</p>
              <div class="options">
                <label>
                  <input type="radio" name="coverage" value="70">
                  Moderate vaccine coverage (70%)
                </label>
                <label>
                  <input type="radio" name="coverage" value="90">
                  High vaccine coverage (90%)
                </label>
              </div>
            </div>
            <!-- Incentives for Vaccination -->
            <div class="input-level-card">
              <h3>Incentives/Benefits for Vaccination</h3>
              <p>Benchmark: None (No incentives)</p>
              <div class="options">
                <label>
                  <input type="radio" name="incentive" value="paid">
                  Paid time off for vaccination (1-3 days)
                </label>
                <label>
                  <input type="radio" name="incentive" value="govsub">
                  Government subsidy/discount on services
                </label>
              </div>
            </div>
            <!-- Exemption Policy -->
            <div class="input-level-card">
              <h3>Exemption Policy</h3>
              <p>Benchmark: Medical exemptions only</p>
              <div class="options">
                <label>
                  <input type="radio" name="exemption" value="medRel">
                  Medical and religious exemptions
                </label>
                <label>
                  <input type="radio" name="exemption" value="all">
                  Medical, religious, and broad personal belief exemptions
                </label>
              </div>
            </div>
          </div>
          <div class="buttons-row">
            <button type="button" onclick="calculateScenario()">Calculate &amp; View Results</button>
          </div>
        </form>
        <!-- Modal Popup for Results -->
        <div id="resultModal" class="modal">
          <div class="modal-content">
            <span class="close-button" onclick="closeModal()">&times;</span>
            <div id="modalResults"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- MRS Tab -->
    <section id="mrsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info card">
        <h4>Marginal Rate of Substitution (MRS) Among Attributes</h4>
        <p>
          The MRS quantifies the trade-offs between attributes. For example, the MRS for Infection Threshold versus Vaccine Coverage indicates how much improvement in coverage is needed to offset a less favorable threshold.
        </p>
        <div class="chart-grid">
          <div class="chart-box">
            <canvas id="mrsChart"></canvas>
          </div>
        </div>
        <div id="mrsInfo"></div>
      </div>
    </section>

    <!-- Predicted Uptake Tab -->
    <section id="probTab" class="tabcontent" tabindex="0">
      <div class="calculation-info card">
        <h4>Predicted Mandate Uptake</h4>
        <p>
          Click “Show Uptake Chart” to compute the predicted uptake percentage and the estimated number of participants (base = 2000 per country).
        </p>
        <div class="buttons-row">
          <button onclick="renderUptakeChart()">Show Uptake Chart</button>
        </div>
        <div class="chart-grid">
          <div class="chart-box" style="position: relative; height:300px;">
            <canvas id="uptakeChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Costs & Benefits Tab -->
    <section id="costsTab" class="tabcontent" tabindex="0">
      <div class="calculation-info card">
        <h4>Costs &amp; Benefits Analysis</h4>
        <p>
          This analysis details the cost components and benefits of the vaccine mandate scenario. Costs include fixed administrative and enforcement expenses plus variable costs per compliant individual. Benefits are estimated from reduced healthcare costs and improved public health outcomes.
        </p>
        <div id="costsBenefitsResults"></div>
      </div>
    </section>

    <!-- Saved Scenarios Tab -->
    <section id="scenariosTab" class="tabcontent" tabindex="0">
      <div class="calculation-info card">
        <h4>Saved Scenarios</h4>
        <p>
          Each row displays the selected inputs along with the computed predicted uptake and estimated participants.
        </p>
        <div class="buttons-row">
          <button onclick="saveScenario()">Save Current Scenario</button>
          <button onclick="openComparison()">Compare &amp; Export to PDF</button>
        </div>
        <div class="table-container">
          <table id="scenarioTable">
            <thead>
              <tr>
                <th>Name</th>
                <th>Country</th>
                <th>Scope</th>
                <th>Threshold</th>
                <th>Coverage</th>
                <th>Incentive</th>
                <th>Exemption</th>
                <th>Uptake (%)</th>
                <th>Participants</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>

    <footer>
      <p>&copy; 2025 Vaccine Mandate Decision Aid Tool</p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>
</html>
